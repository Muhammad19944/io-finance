import { createServer, Model, Factory, RestSerializer } from "miragejs"

export default function makeServer() {
    createServer({
        serializers: { application: RestSerializer },

        models: {
          account: Model,
          invoice: Model,
          monitoring: Model
        },
      
        routes() {
            this.namespace = "api"
        
            this.get("/account", (schema) => {
                return schema.accounts.all()
            })

            this.get("/invoice", (schema) => {
                return schema.invoices.all()
            })

            this.get('/monitoring', (schema) => {
                return schema.monitorings.all()
            })
        },

        factories: {
            account: Factory.extend({
                accountName(i) {
                    return 123456789
                },
                accountBalance(i) {
                    return `${i + 1}`
                },
                accountCurrency() {
                    let currencyText = ['Dollar', 'Pound']

                    return currencyText[Math.floor(Math.random() * currencyText.length)] // возвращаем рандомные значение валют для аккаунта
                }
            }),
            invoice: Factory.extend({
                name(i) {
                    return `IO-BN-${i}`
                },
                status() {
                    let statusText = ['Paid', 'Pending', 'Cancelled']

                    return statusText[Math.floor(Math.random() * statusText.length)] // возвращаем рандомные значение для статусов
                }
            }),
            monitoring: Factory.extend({
                name(i) {
                    return `IO-BN-${i}`
                },
                status() {
                    let statusText = ['Paid', 'Pending', 'Cancelled']

                    return statusText[Math.floor(Math.random() * statusText.length)] // возвращаем рандомные значение для статусов
                }
            })
        },

        seeds(server) {
            server.createList("invoice", 15)
            server.createList("account", 2)
            server.createList("monitoring", 15)
        }
    })
}