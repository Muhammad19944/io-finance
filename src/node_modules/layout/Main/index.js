import React from 'react'
import {Route, Switch, useRouteMatch, Redirect} from 'react-router-dom'
import {Layout} from 'antd';

const {Header, Footer, Sider, Content} = Layout;
import routes from 'routes'

import AppSidebar from 'components/Sidebar';
import AppHeader from 'components/Header'
import AppFooter from 'components/Footer'
import ContactUs from 'pages/Main/ContactUs'
import './index.css'


let setVH = function () {
    let vh = window.innerHeight * 0.01;
    document.documentElement.style.setProperty(`--vh`, `${vh}px`);
};

setVH();

window.addEventListener(`resize`, setVH);

export const MainRouteChunk = React.createContext()

const Main = () => {
	const {path} = useRouteMatch()

	return (
		<MainRouteChunk.Provider value={path}>
			<div className='main-layout'>
				<Layout>
					<Sider width={250}>
						<AppSidebar/>
					</Sider>
					<Layout>
						<Header>
							<AppHeader/>
						</Header>
						<Content className='app-content d-flex f-column py-5 px-7'>
							<Switch>
								{routes.map((route, index) => (
									<Route
										key={index}
										path={route.path}
										exact={route.exact}
										children={route.component}
									/>
								))}

								<Route path={`${path}/contact-us`}>
									<ContactUs/>
								</Route>
								<Redirect to={`${path}/dashboard`}/>
							</Switch>
						</Content>
						<Footer>
							<AppFooter/>
						</Footer>
					</Layout>
				</Layout>
			</div>
		</MainRouteChunk.Provider>
	)
}

export default Main